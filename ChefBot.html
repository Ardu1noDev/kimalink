<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Culinary Chatbot</title>
<!-- Inter font -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
<!-- Material Icons -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
<style>
  /* Reset and base */
  *, *::before, *::after {
    box-sizing: border-box;
  }
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
  }
  body {
    font-family: 'Inter', sans-serif;
    /* Background green lettuce (#9ed56f) fading to white vertical gradient */
    background: linear-gradient(180deg, #9ed56f 0%, #ffffff 100%);
    color: #222;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }
  a {
    color: inherit;
    text-decoration: none;
  }

  /* Layout containers */
  #app {
    display: grid;
    grid-template-columns: 0fr 1fr 0fr;
    grid-template-rows: auto 1fr auto;
    height: 100vh;
    width: 100vw; /* Full viewport width */
    box-shadow: 0 10px 30px rgb(0 0 0 / 0.1);
  }

  /* Responsive grid columns */
  @media (max-width: 767px) {
    #app {
      grid-template-columns: 1fr;
      grid-template-rows: auto 1fr auto;
    }
  }
  @media (min-width: 768px) and (max-width: 1023px) {
    #app {
      grid-template-columns: 280px 1fr;
      grid-template-rows: auto 1fr auto;
    }
  }
  @media (min-width: 1024px) {
    #app {
      grid-template-columns: 320px 1fr 280px;
      grid-template-rows: auto 1fr auto;
    }
  }
  @media (min-width: 1440px) {
    /* Remove max-width, fill full width */
    #app {
      /* No max width */
    }
  }

  /* Sidebar Styles */
  #sidebar {
    background: #fff8f0;
    border-right: 1px solid #efdfd5;
    display: flex;
    flex-direction: column;
    padding: 24px 16px;
    gap: 24px;
  }
  @media (max-width: 767px) {
    #sidebar {
      display: none;
    }
  }

  #sidebar-header {
    font-weight: 700;
    font-size: 1.75rem;
    color: #d35400;
    user-select: none;
  }

  /* Conversations List */
  #conversations {
    flex: 1;
    overflow-y: auto;
  }
  #conversations::-webkit-scrollbar {
    width: 6px;
  }
  #conversations::-webkit-scrollbar-thumb {
    background-color: #d35400aa;
    border-radius: 3px;
  }

  .conversation-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 10px 12px;
    border-radius: 12px;
    cursor: pointer;
    transition: background-color 0.2s ease;
  }
  .conversation-item:hover,
  .conversation-item.active {
    background: #ffe7d1;
  }
  .conversation-avatar {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    object-fit: cover;
    flex-shrink: 0;
    background: #f0ddd0;
    border: 2px solid #d35400;
  }
  .conversation-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  .conversation-name {
    font-weight: 700;
    font-size: 1rem;
    white-space: nowrap;
    text-overflow: ellipsis;
    overflow: hidden;
    color: #a03800;
  }
  .conversation-last-message {
    font-size: 0.875rem;
    color: #996633;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .conversation-time {
    font-size: 0.75rem;
    color: #b67329;
    flex-shrink: 0;
  }

  /* Chat header */
  #chat-header {
    background: #fef6eb;
    border-bottom: 1px solid #ecdac6;
    padding: 16px 32px;
    display: flex;
    align-items: center;
    gap: 16px;
    position: sticky;
    top: 0;
    z-index: 10;
  }
  #chat-header .avatar {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #d35400;
  }
  #chat-header .user-info {
    display: flex;
    flex-direction: column;
  }
  #chat-header .user-name {
    font-weight: 700;
    font-size: 1.25rem;
    color: #a03800;
  }
  #chat-header .user-status {
    font-size: 0.875rem;
    color: #7c5a37;
  }
  #chat-header .header-icons {
    margin-left: auto;
    display: flex;
    gap: 16px;
  }

  /* Chat container */
  #chat-container {
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  #chat-messages {
    flex: 1;
    overflow-y: auto;
    padding: 20px 32px 24px 32px;
    background: #fff8f0;
    display: flex;
    flex-direction: column;
    gap: 16px;
    scroll-behavior: smooth;
  }
  #chat-messages::-webkit-scrollbar {
    width: 8px;
  }
  #chat-messages::-webkit-scrollbar-thumb {
    background-color: #d35400bb;
    border-radius: 4px;
  }

  /* Message bubbles */
  .message {
    max-width: 75%;
    border-radius: 20px 20px 20px 4px;
    padding: 14px 18px;
    font-size: 1rem;
    line-height: 1.3;
    position: relative;
    word-wrap: break-word;
    box-shadow: 0 2px 8px rgb(211 84 0 / 0.1);
    display: flex;
    gap: 12px;
    align-items: flex-end;
  }
  .message.received {
    background: #ffebd6;
    border-top-left-radius: 4px;
    align-self: flex-start;
  }
  .message.sent {
    background: #d35400;
    color: white;
    border-radius: 20px 20px 4px 20px;
    align-self: flex-end;
  }
  .message .message-avatar {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    border: 2px solid #d35400;
    flex-shrink: 0;
    object-fit: cover;
    background: #f0ddd0;
  }
  .message .content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 6px;
  }
  .message .text {
    white-space: pre-wrap;
  }
  .message .time {
    font-size: 0.75rem;
    color: #933e00;
    align-self: flex-end;
    user-select: none;
  }

  /* Special message types */
  .message .image-message img {
    max-width: 220px;
    border-radius: 16px;
    object-fit: cover;
    box-shadow: 0 4px 12px rgb(211 84 0 / 0.15);
  }
  .message .file-message {
    display: inline-flex;
    background: rgba(255 255 255 / 0.2);
    padding: 8px 12px;
    border-radius: 12px;
    gap: 8px;
    align-items: center;
  }
  .message .file-message .material-icons {
    font-size: 28px;
    color: #fbe2d5;
  }
  .message .file-message a {
    color: white;
    font-weight: 600;
    text-decoration: underline;
  }

  /* Message input area */
  #chat-input-area {
    background: #fff8f0;
    border-top: 1px solid #efdfd5;
    padding: 16px 32px;
    display: flex;
    gap: 16px;
    align-items: center;
  }
  #chat-input-area textarea {
    flex: 1 1 auto;
    resize: none;
    border: 1px solid #d9c3b0;
    border-radius: 24px;
    padding: 12px 16px;
    font-family: 'Inter', sans-serif;
    font-size: 1rem;
    min-height: 44px;
    max-height: 144px;
    line-height: 1.4;
  }
  #chat-input-area textarea:focus {
    outline: 2px solid #d35400;
    border-color: #d35400;
  }
  #chat-input-area button.icon-btn {
    background: none;
    border: none;
    cursor: pointer;
    color: #d35400;
    font-size: 28px;
    transition: color 0.2s ease;
  }
  #chat-input-area button.icon-btn:disabled {
    color: #d35400aa;
    cursor: default;
  }
  #chat-input-area button.icon-btn:hover:not(:disabled),
  #chat-input-area button.icon-btn:focus:not(:disabled) {
    color: #a03800;
    outline: none;
  }

  /* Emoji picker container */
  #emoji-picker {
    position: absolute;
    bottom: 80px;
    right: 60px;
    background: #fff8f0;
    border: 1px solid #d9c3b0;
    border-radius: 20px;
    box-shadow: 0 6px 20px rgb(211 84 0 / 0.15);
    padding: 12px;
    display: none;
    width: 280px;
    max-height: 320px;
    overflow-y: auto;
    z-index: 100;
  }
  #emoji-picker .emoji {
    font-size: 24px;
    cursor: pointer;
    user-select: none;
    padding: 6px;
    border-radius: 8px;
    transition: background-color 0.15s ease;
    display: inline-block;
  }
  #emoji-picker .emoji:hover {
    background-color: #ffd9b3;
  }

  /* Right panel placeholder (e.g. recipe/news feed) */
  #right-panel {
    background: #fff8f0;
    border-left: 1px solid #efdfd5;
    padding: 24px 16px;
    display: flex;
    flex-direction: column;
    gap: 20px;
    overflow-y: auto;
    font-size: 0.9rem;
    color: #a6622b;
  }
  #right-panel h3 {
    font-size: 1.25rem;
    font-weight: 700;
    color: #d35400;
    margin-bottom: 12px;
  }

  /* Scroll fade effect for chat messages */
  #chat-messages::before {
    content: "";
    position: sticky;
    top: 0;
    height: 6px;
    pointer-events: none;
    background: linear-gradient(to bottom, #fff8f0, transparent);
    z-index: 2;
  }

  /* Media Query additional refinements */
  @media (max-width: 1023px) {
    #right-panel {
      display: none;
    }
  }
</style>
</head>
<body>
<div id="app" role="main" aria-label="Culinary chatbot application">
  <!-- Sidebar: conversation list -->
  <aside id="sidebar" aria-label="Conversation list">
    <header id="sidebar-header">FoodChat</header>
    <section id="conversations" role="list" aria-label="Chat conversations list">
      <!-- Conversation items inserted by JS -->
    </section>
  </aside>

  <!-- Chat main content -->
  <section id="chat-container" aria-live="polite" aria-relevant="additions" aria-atomic="false">
    <header id="chat-header" role="banner">
      <img src="" alt="" class="avatar" id="chat-header-avatar" />
      <div class="user-info">
        <div class="user-name" id="chat-header-name">...</div>
        <div class="user-status" id="chat-header-status">Offline</div>
      </div>
      <div class="header-icons">
        <!-- Icons removed as requested -->
      </div>
    </header>
    <div id="chat-messages" role="log" aria-live="polite" aria-relevant="additions">
      <!-- Chat messages inserted by JS -->
    </div>
    <form id="chat-input-area" aria-label="Send message form">
      <button class="icon-btn" type="button" id="btn-attach" aria-label="Attach media" title="Attach media">
        <span class="material-icons">attach_file</span>
      </button>
      <textarea id="message-input" placeholder="Type your message..." rows="1" aria-autocomplete="list" aria-label="Message input"></textarea>
      <button class="icon-btn" type="button" id="btn-emoji" aria-label="Emoji picker" title="Insert emoji">
        <span class="material-icons">emoji_emotions</span>
      </button>
      <button class="icon-btn" type="submit" id="btn-send" aria-label="Send message" title="Send message" disabled>
        <span class="material-icons">send</span>
      </button>
    </form>
    <div id="emoji-picker" role="list" aria-label="Emoji picker" tabindex="0">
      <!-- Emoji list inserted by JS -->
    </div>
  </section>

  <!-- Right panel (optional: e.g. culinary tips or recipes) -->
  <aside id="right-panel" aria-label="Culinary tips and recipes">
    <h3>Recipe of the Day</h3>
    <article>
      <h4>Classic Pumpkin Soup</h4>
      <p>A warm and creamy pumpkin soup with a hint of spice, perfect for cozy evenings.</p>
      <ul>
        <li>Ingredients: Pumpkin, onion, garlic, cream, chicken broth, nutmeg, salt, pepper.</li>
        <li>Cook time: approx. 45 minutes.</li>
        <li>Tip: Garnish with roasted pumpkin seeds and fresh parsley.</li>
      </ul>
    </article>
    <h3>Culinary Tips</h3>
    <ul>
      <li>Use fresh herbs for richer flavors.</li>
      <li>Balance acidity with sweetness for surprise taste.</li>
      <li>Toast spices gently for enhanced aroma.</li>
    </ul>
  </aside>
</div>

<script>
(() => {
  'use strict';

  // Demo users - only Alice included
  const users = {
    bot: {
      id: 'bot',
      name: 'Chef Bot',
      avatar: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/a61050d6-7d56-48ae-9fa0-e0bee8d2ca68.png',
      status: 'Online',
      isBot: true,
    },
    user1: {
      id: 'user1',
      name: 'Alice',
      avatar: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/d9b7c776-b111-436b-829e-45d2fb728453.png',
      status: 'Online',
    }
  };

  // Only one conversation with Alice, with empty messages array
  const conversations = [
    {
      id: 'conv1',
      userId: 'user1',
      lastMessage: '',
      lastTime: '',
      messages: []
    }
  ];

  // State
  let selectedConversationId = conversations[0].id;
  let emojiPickerVisible = false;

  // DOM elements
  const convListEl = document.getElementById('conversations');
  const chatMessagesEl = document.getElementById('chat-messages');
  const chatHeaderAvatarEl = document.getElementById('chat-header-avatar');
  const chatHeaderNameEl = document.getElementById('chat-header-name');
  const chatHeaderStatusEl = document.getElementById('chat-header-status');
  const messageInputEl = document.getElementById('message-input');
  const btnSendEl = document.getElementById('btn-send');
  const btnEmojiEl = document.getElementById('btn-emoji');
  const emojiPickerEl = document.getElementById('emoji-picker');

  // Render conversation list
  function renderConversationList() {
    convListEl.innerHTML = '';
    conversations.forEach(conv => {
      const user = users[conv.userId];
      if(!user) return;

      const item = document.createElement('div');
      item.classList.add('conversation-item');
      if(conv.id === selectedConversationId) item.classList.add('active');
      item.setAttribute('role', 'listitem');
      item.setAttribute('tabindex', '0');
      item.dataset.convId = conv.id;
      item.innerHTML = `
        <img class="conversation-avatar" src="${user.avatar}" alt="Avatar of ${user.name}">
        <div class="conversation-info">
          <div class="conversation-name">${user.name}</div>
          <div class="conversation-last-message" title="${conv.lastMessage}">${conv.lastMessage}</div>
        </div>
        <div class="conversation-time">${conv.lastTime}</div>
      `;
      item.addEventListener('click', () => {
        if(selectedConversationId !== conv.id) {
          selectConversation(conv.id);
        }
      });
      item.addEventListener('keypress', (e) => {
        if(e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          item.click();
        }
      });
      convListEl.appendChild(item);
    });
  }

  // Render chat header
  function renderChatHeader(conv) {
    const user = users[conv.userId] || users.bot;
    chatHeaderAvatarEl.src = user.avatar;
    chatHeaderAvatarEl.alt = `Avatar of ${user.name}`;
    chatHeaderNameEl.textContent = user.name;
    chatHeaderStatusEl.textContent = user.status || 'Offline';
  }

  // Render message bubble, none since no messages initially
  function createMessageElement(message, conv) {
    const msgEl = document.createElement('div');
    const isSent = message.sender === 'bot' ? false : message.sender === conv.userId ? true : false;

    msgEl.classList.add('message', isSent ? 'sent' : 'received');
    msgEl.setAttribute('role', 'article');
    msgEl.setAttribute('aria-label', `${users[message.sender]?.name || 'Unknown'} message`);

    if (!isSent) {
      const avatarImg = document.createElement('img');
      avatarImg.classList.add('message-avatar');
      avatarImg.src = users[message.sender]?.avatar || users.bot.avatar;
      avatarImg.alt = `Avatar of ${users[message.sender]?.name || 'Chatbot'}`;
      msgEl.appendChild(avatarImg);
    }

    const contentEl = document.createElement('div');
    contentEl.className = 'content';

    if(message.type === 'text') {
      const textEl = document.createElement('div');
      textEl.className = 'text';
      textEl.textContent = message.content;
      contentEl.appendChild(textEl);
    } else if(message.type === 'image') {
      const imgWrapper = document.createElement('div');
      imgWrapper.className = 'image-message';
      const imgEl = document.createElement('img');
      imgEl.src = message.content;
      imgEl.alt = message.alt || 'Image message';
      imgWrapper.appendChild(imgEl);
      contentEl.appendChild(imgWrapper);
    } else if(message.type === 'file') {
      const fileWrapper = document.createElement('div');
      fileWrapper.className = 'file-message';
      fileWrapper.innerHTML = `
        <span class="material-icons" aria-hidden="true">insert_drive_file</span>
        <a href="${message.fileUrl || '#'}" download="${message.content}" title="${message.content}">${message.content}</a>
      `;
      contentEl.appendChild(fileWrapper);
    }

    const timeEl = document.createElement('div');
    timeEl.className = 'time';
    timeEl.textContent = message.time;
    contentEl.appendChild(timeEl);

    msgEl.appendChild(contentEl);
    return msgEl;
  }

  // Render messages (empty at start)
  function renderMessages(conv) {
    chatMessagesEl.innerHTML = '';
    conv.messages.forEach(msg => {
      chatMessagesEl.appendChild(createMessageElement(msg, conv));
    });
    scrollToBottom();
  }

  // Scroll chat window bottom
  function scrollToBottom() {
    chatMessagesEl.scrollTop = chatMessagesEl.scrollHeight;
  }

  // Select conversation
  function selectConversation(id) {
    selectedConversationId = id;
    const conv = conversations.find(c => c.id === id);
    if(!conv) return;
    renderConversationList();
    renderChatHeader(conv);
    renderMessages(conv);
  }

  // Enable/disable send button
  function updateSendButton() {
    const val = messageInputEl.value.trim();
    btnSendEl.disabled = val.length === 0;
  }

  // Toggle emoji picker
  function toggleEmojiPicker() {
    emojiPickerVisible = !emojiPickerVisible;
    emojiPickerEl.style.display = emojiPickerVisible ? 'block' : 'none';
    if(emojiPickerVisible) {
      emojiPickerEl.focus();
    }
  }

  // Insert emoji at cursor position
  function insertAtCursor(myField, myValue) {
    const startPos = myField.selectionStart;
    const endPos = myField.selectionEnd;
    const before = myField.value.substring(0, startPos);
    const after = myField.value.substring(endPos, myField.value.length);
    myField.value = before + myValue + after;
    myField.selectionStart = startPos + myValue.length;
    myField.selectionEnd = startPos + myValue.length;
    myField.focus();
  }

  // Send message logic without bot reply
  function sendMessage() {
    const text = messageInputEl.value.trim();
    if(!text) return;
    const conv = conversations.find(c => c.id === selectedConversationId);
    if(!conv) return;

    const timeStr = new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
    const newMsg = {
      sender: conv.userId,
      time: timeStr,
      type: 'text',
      content: text
    };
    conv.messages.push(newMsg);
    conv.lastMessage = text;
    conv.lastTime = timeStr;

    renderConversationList();
    renderMessages(conv);
    scrollToBottom();

    messageInputEl.value = '';
    btnSendEl.disabled = true;
  }

  // Emoji data subset
  const emojis = [
    "ðŸ˜€","ðŸ˜ƒ","ðŸ˜„","ðŸ˜","ðŸ˜†","ðŸ˜…","ðŸ¤£","ðŸ˜‚","ðŸ™‚","ðŸ™ƒ",
    "ðŸ˜‰","ðŸ˜Š","ðŸ˜‡","ðŸ¥°","ðŸ˜","ðŸ¤©","ðŸ˜˜","ðŸ˜—","â˜ºï¸","ðŸ˜š",
    "ðŸ˜™","ðŸ˜‹","ðŸ˜›","ðŸ˜œ","ðŸ¤ª","ðŸ˜","ðŸ¤‘","ðŸ¤—","ðŸ¤­","ðŸ¤«",
    "ðŸ¤”","ðŸ¤","ðŸ¤¨","ðŸ˜","ðŸ˜‘","ðŸ˜¶","ðŸ˜","ðŸ˜’","ðŸ™„","ðŸ˜¬",
    "ðŸ¤¥","ðŸ˜Œ","ðŸ˜”","ðŸ˜ª","ðŸ¤¤","ðŸ˜´","ðŸ˜·","ðŸ¤’","ðŸ¤•","ðŸ¤¢",
    "ðŸ¤®","ðŸ¤§","ðŸ¥µ","ðŸ¥¶","ðŸ¥´","ðŸ˜µ","ðŸ¤¯","ðŸ¤ ","ðŸ¥³","ðŸ˜Ž"
  ];

  // Render emoji picker
  function renderEmojiPicker() {
    emojiPickerEl.innerHTML = '';
    emojis.forEach(emoji => {
      const emojiEl = document.createElement('button');
      emojiEl.className = 'emoji';
      emojiEl.type = 'button';
      emojiEl.textContent = emoji;
      emojiEl.setAttribute('aria-label', `Insert emoji ${emoji}`);
      emojiEl.addEventListener('click', () => {
        insertAtCursor(messageInputEl, emoji);
        messageInputEl.focus();
        updateSendButton();
      });
      emojiPickerEl.appendChild(emojiEl);
    });
  }

  // Attach event listeners
  function attachEventListeners() {
    // Send message on form submit
    document.getElementById('chat-input-area').addEventListener('submit', e => {
      e.preventDefault();
      sendMessage();
    });

    // Enable/disable send button on input change
    messageInputEl.addEventListener('input', updateSendButton);

    // Emoji button toggle
    btnEmojiEl.addEventListener('click', e => {
      e.stopPropagation();
      toggleEmojiPicker();
    });

    // Hide emoji picker on outside click
    document.body.addEventListener('click', () => {
      if (emojiPickerVisible) {
        emojiPickerVisible = false;
        emojiPickerEl.style.display = 'none';
      }
    });

    // Adjust textarea height dynamically
    messageInputEl.addEventListener('input', () => {
      messageInputEl.style.height = 'auto';
      messageInputEl.style.height = Math.min(messageInputEl.scrollHeight, 144) + 'px';
    });
  }

  // Initialize
  function init() {
    renderConversationList();
    renderEmojiPicker();
    selectConversation(selectedConversationId);
    attachEventListeners();
    updateSendButton();
  }

  // Run init on DOMContentLoaded
  if(document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
})();
</script>
</body>
</html>

